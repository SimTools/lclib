C***********************************************************************
C*
C* ------------------
C* Subroutine  SPJBTM
C* ------------------
C*
C*(Function)
C*  Spring job termination.
C*
C*(Author)
C*  A.Miyamoto  9-Feb-1990
C*                                                                     *
C***********************************************************************
C
      SUBROUTINE SPJBTM
C
      IMPLICIT REAL*8 (A-H,O-Z)
#ifdef TAYM
      EXTERNAL FUNC
#endif 
C
      COMMON /SPPARM/ NADSPF, MXTRY, NEVENT
      REAL*4   SETIME,TIME1,TIME2,UTIME,XTIME,DTIME,CTIME
      COMMON /SPTIME/ SETIME,TIME1,TIME2,UTIME,XTIME,DTIME,CTIME
      COMMON /BASE0/ NDUM(4),IBASES
      COMMON/LOOP1/ LOOP,MXLOOP
      COMMON/LOOP0/ LOOPC,IRCODE
      COMMON/XHCNTL/ LOCK
 
C
        IF( NEVENT .GT. 0 ) THEN
          WRITE(6,9500) NEVENT,CTIME,TIME2
 9500     FORMAT(/1H1,//1H ,
     .           /20X,'*************************************',
     .           /20X,'*                                   *',
     .           /20X,'*      END   OF   SPRING            *',
     .           /20X,'*                                   *',
     .           /20X,'*   No. of Generated events         *',
     .           /20X,'*   ',6X,I10,7X,          '         *',
     .           /20X,'*                                   *',
     .           /20X,'*   Net CPU time for generation     *',
     .           /20X,'*         ',F10.3, ' seconds        *',
     .           /20X,'*                                   *',
     .           /20X,'*   GO time                         *',
     .           /20X,'*         ',F10.3, ' seconds        *',
     .           /20X,'*                                   *',
     .           /20X,'*************************************')
C
          CALL SHPLOT
C
        ELSE
          WRITE(6,9600)
 9600     FORMAT(/1H1,//1H ,
     .    /10X,'*************************************************',
     .    /10X,'*                                               *',
     .    /10X,'*   There is no event generated by the SPRING.  *',
     .    /10X,'*                                               *',
     .    /10X,'*************************************************')
        ENDIF
C
        CALL SPTERM
C
      RETURN
      END
