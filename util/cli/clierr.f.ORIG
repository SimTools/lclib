C   18/12/86 902071604  MEMBER NAME  CLIERR   (FORT)     M  FORTRAN
C
       SUBROUTINE CLIERR( LEVEL,MESAGE )
C
C (Purpose) Show Error Message for CLI
C (Author ) A.Shirahashi
C (Date   ) 12-Nov-1986
C (Input  ) LEVEL 0: Information Level
C           LEVEL 1: Warning Level
C           LEVEL 2: Error Level
C           MESSAGE: Message string to be displayed
C
C ARG
C      (Input)
       INTEGER * 4  LEVEL
       CHARACTER * ( * )  MESAGE
C
C COMMON
C     PARAMETER( LUNMAX = 8 )
C     COMMON /UNITRD/ IRD,IWR,HELSET,TTCHAN,KLUN,
C    &                LUNIN,LUNPTR,LUNLST(0:LUNMAX)
       include '_unitrd.inc'
C
C VAR
       CHARACTER * 8  PREFIX
       LOGICAL   * 4  YES
C
C FUNC
       LOGICAL * 4  IFTSS
C
C BEGIN
       IF( LEVEL .EQ. 0 ) THEN
         PREFIX = '%CLI-I, '
       ELSE IF( LEVEL .EQ. 1 ) THEN
         PREFIX = '%CLI-W, '
       ELSE IF( LEVEL .EQ. 2 ) THEN
         PREFIX = '%CLI-E, '
       END IF
C
       LMSG = LENRD( MESAGE )
       WRITE( 6,'(1H ,A,A)' ) PREFIX,MESAGE(:LMSG)
C
       IF( LEVEL.LE.0 ) RETURN
       IF( .NOT.IFTSS() .OR. LUNIN.EQ.5 .OR. LUNPTR.EQ.0 ) RETURN
C
       YES = .TRUE.
       CALL AFFIRM( 'Continue to Execute Command Procedure', YES )
       IF( .NOT.YES ) CALL CLSTOP()
C
       RETURN
       END
